<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="imports.html">

<dom-module id="ros-rviz-grid">
  <template>
    <paper-input label="Cell size (m)" value="{{cellSize}}"></paper-input>
    <paper-input label="Color" value="{{color}}"></paper-input>
    <paper-input label="# cells per side" value="{{numCells}}"></paper-input>
  </template>
  <script>
    Polymer({
      is: 'ros-rviz-grid',

      properties: {
        cellSize: {
          type: Number,
          value: 1,
        },
        color: {
          type: String,
          value: '#cccccc',
        },
        name: {
          type: String,
          value: 'Grid',
        },
        numCells: {
          type: Number,
          value: 10,
        },
        globalOptions: Object,
        _grid: Object,
        _viewer: Object,
      },

      observers: [
        '_onOptionsChanged(cellSize, color, numCells)',
      ],

      addToViewer: function() {
        if (this._viewer) {
          this._viewer.addObject(this._grid);
        }
      },

      updateDisplay: function(viewer, ros, tfClient, callback) {
        var that = this;
        this._viewer = viewer;
        this._grid = new ROS3D.Grid({
          cellSize: that.cellSize,
          color: that.color,
          lineWidth: that.lineWidth,
          num_cells: that.numCells,
        });
        callback && callback();
      },

      removeFromViewer: function() {
        if (this._viewer) {
          this._viewer.scene.remove(this._grid);
        }
      },

      _onOptionsChanged: function(cellSize, color, numCells) {
        this.fire('update');
      },
    });
  </script>
</dom-module>
